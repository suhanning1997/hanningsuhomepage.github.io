<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   <!--
This HTML was auto-generated from MATLAB code.
To make changes, update the MATLAB code and republish this document.
      --><title>RunPreproc_Template_job</title><meta name="generator" content="MATLAB 9.10"><link rel="schema.DC" href="http://purl.org/dc/elements/1.1/"><meta name="DC.date" content="2021-08-17"><meta name="DC.source" content="RunPreproc_Template_job.m"><style type="text/css">
html,body,div,span,applet,object,iframe,h1,h2,h3,h4,h5,h6,p,blockquote,pre,a,abbr,acronym,address,big,cite,code,del,dfn,em,font,img,ins,kbd,q,s,samp,small,strike,strong,tt,var,b,u,i,center,dl,dt,dd,ol,ul,li,fieldset,form,label,legend,table,caption,tbody,tfoot,thead,tr,th,td{margin:0;padding:0;border:0;outline:0;font-size:100%;vertical-align:baseline;background:transparent}body{line-height:1}ol,ul{list-style:none}blockquote,q{quotes:none}blockquote:before,blockquote:after,q:before,q:after{content:'';content:none}:focus{outine:0}ins{text-decoration:none}del{text-decoration:line-through}table{border-collapse:collapse;border-spacing:0}

html { min-height:100%; margin-bottom:1px; }
html body { height:100%; margin:0px; font-family:Arial, Helvetica, sans-serif; font-size:10px; color:#000; line-height:140%; background:#fff none; overflow-y:scroll; }
html body td { vertical-align:top; text-align:left; }

h1 { padding:0px; margin:0px 0px 25px; font-family:Arial, Helvetica, sans-serif; font-size:1.5em; color:#d55000; line-height:100%; font-weight:normal; }
h2 { padding:0px; margin:0px 0px 8px; font-family:Arial, Helvetica, sans-serif; font-size:1.2em; color:#000; font-weight:bold; line-height:140%; border-bottom:1px solid #d6d4d4; display:block; }
h3 { padding:0px; margin:0px 0px 5px; font-family:Arial, Helvetica, sans-serif; font-size:1.1em; color:#000; font-weight:bold; line-height:140%; }

a { color:#005fce; text-decoration:none; }
a:hover { color:#005fce; text-decoration:underline; }
a:visited { color:#004aa0; text-decoration:none; }

p { padding:0px; margin:0px 0px 20px; }
img { padding:0px; margin:0px 0px 20px; border:none; }
p img, pre img, tt img, li img, h1 img, h2 img { margin-bottom:0px; }

ul { padding:0px; margin:0px 0px 20px 23px; list-style:square; }
ul li { padding:0px; margin:0px 0px 7px 0px; }
ul li ul { padding:5px 0px 0px; margin:0px 0px 7px 23px; }
ul li ol li { list-style:decimal; }
ol { padding:0px; margin:0px 0px 20px 0px; list-style:decimal; }
ol li { padding:0px; margin:0px 0px 7px 23px; list-style-type:decimal; }
ol li ol { padding:5px 0px 0px; margin:0px 0px 7px 0px; }
ol li ol li { list-style-type:lower-alpha; }
ol li ul { padding-top:7px; }
ol li ul li { list-style:square; }

.content { font-size:1.2em; line-height:140%; padding: 20px; }

pre, code { font-size:12px; }
tt { font-size: 1.2em; }
pre { margin:0px 0px 20px; }
pre.codeinput { padding:10px; border:1px solid #d3d3d3; background:#f7f7f7; }
pre.codeoutput { padding:10px 11px; margin:0px 0px 20px; color:#4c4c4c; }
pre.error { color:red; }

@media print { pre.codeinput, pre.codeoutput { word-wrap:break-word; width:100%; } }

span.keyword { color:#0000FF }
span.comment { color:#228B22 }
span.string { color:#A020F0 }
span.untermstring { color:#B20000 }
span.syscmd { color:#B28C00 }
span.typesection { color:#A0522D }

.footer { width:auto; padding:10px 0px; margin:25px 0px 0px; border-top:1px dotted #878787; font-size:0.8em; line-height:140%; font-style:italic; color:#878787; text-align:left; float:none; }
.footer p { margin:0px; }
.footer a { color:#878787; }
.footer a:hover { color:#878787; text-decoration:underline; }
.footer a:visited { color:#878787; }

table th { padding:7px 5px; text-align:left; vertical-align:middle; border: 1px solid #d6d4d4; font-weight:bold; }
table td { padding:7px 5px; text-align:left; vertical-align:top; border:1px solid #d6d4d4; }





  </style></head><body><div class="content"><pre class="codeinput"><span class="comment">%-----------------------------------------------------------------------</span>
<span class="comment">% Job saved on 06-Aug-2021 19:11:17 by cfg_util (rev $Rev: 7345 $)</span>
<span class="comment">% spm SPM - SPM12 (7771)</span>
<span class="comment">% cfg_basicio BasicIO - Unknown</span>
<span class="comment">%-----------------------------------------------------------------------</span>


subjects = [02 03]

<span class="comment">%user  = getenv("USERNAME"); % Will return the username</span>

<span class="keyword">for</span> subject = subjects
</pre><pre class="codeinput">    subject = num2str(subject, <span class="string">'%02d'</span>); <span class="comment">% Zero-pads each number so that the subject ID is 2 characters long</span>

    <span class="comment">%%%%%%%%%%</span>

    <span class="comment">% Check whether the files have been unzipped. If not, unzip them using</span>
    <span class="comment">% gunzip</span>

    <span class="keyword">if</span> exist([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-1_bold.nii'</span>]) == 0
        display(<span class="string">'Run 1 has not been unzipped; unzipping now'</span>)
        gunzip([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-1_bold.nii.gz'</span>])
    <span class="keyword">else</span>
        display(<span class="string">'Run 1 is already unzipped; doing nothing'</span>)
    <span class="keyword">end</span>

    <span class="keyword">if</span> exist([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-2_bold.nii'</span>]) == 0
        display(<span class="string">'Run 2 has not been unzipped; unzipping now'</span>)
        gunzip([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-2_bold.nii.gz'</span>])
    <span class="keyword">else</span>
        display(<span class="string">'Run 2 is already unzipped; doing nothing'</span>)
    <span class="keyword">end</span>

    <span class="keyword">if</span> exist([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\anat\sub-'</span> subject <span class="string">'_T1w.nii'</span>]) == 0
        display(<span class="string">'Anatomical image has not been unzipped; unzipping now'</span>)
        gunzip([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\anat\sub-'</span> subject <span class="string">'_T1w.nii.gz'</span>])
    <span class="keyword">else</span>
        display(<span class="string">'Anatomical image is already unzipped; doing nothing'</span>)
    <span class="keyword">end</span>

    <span class="comment">%%%%%%%%%%</span>

    <span class="comment">% Execute the code specified in the SPM GUI</span>

    matlabbatch{1}.cfg_basicio.file_dir.file_ops.cfg_named_file.name = <span class="string">'run1run2files'</span>;
    matlabbatch{1}.cfg_basicio.file_dir.file_ops.cfg_named_file.files = {
                                                                         {[<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-1_bold.nii'</span>]}
                                                                         {[<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\sub-'</span> subject <span class="string">'_task-flanker_run-2_bold.nii'</span>]}
                                                                         }';
    matlabbatch{2}.spm.spatial.realign.estwrite.data{1}(1) = cfg_dep(<span class="string">'Named File Selector: run1run2files(1) - Files'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'files'</span>, <span class="string">'{}'</span>,{1}));
    matlabbatch{2}.spm.spatial.realign.estwrite.data{2}(1) = cfg_dep(<span class="string">'Named File Selector: run1run2files(2) - Files'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'files'</span>, <span class="string">'{}'</span>,{2}));
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.quality = 0.9;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.sep = 4;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.fwhm = 5;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.rtm = 1;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.interp = 2;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.wrap = [0 0 0];
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.weight = <span class="string">''</span>;
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.which = [2 1];
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.interp = 4;
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.wrap = [0 0 0];
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.mask = 1;
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.prefix = <span class="string">'r'</span>;
    matlabbatch{3}.spm.temporal.st.scans{1}(1) = cfg_dep(<span class="string">'Realign: Estimate &amp; Reslice: Resliced Images (Sess 1)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{2}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'sess'</span>, <span class="string">'()'</span>,{1}, <span class="string">'.'</span>,<span class="string">'rfiles'</span>));
    matlabbatch{3}.spm.temporal.st.scans{2}(1) = cfg_dep(<span class="string">'Realign: Estimate &amp; Reslice: Resliced Images (Sess 2)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{2}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'sess'</span>, <span class="string">'()'</span>,{2}, <span class="string">'.'</span>,<span class="string">'rfiles'</span>));
    matlabbatch{3}.spm.temporal.st.nslices = 40;
    matlabbatch{3}.spm.temporal.st.tr = 2;
    matlabbatch{3}.spm.temporal.st.ta = 1.95;
    matlabbatch{3}.spm.temporal.st.so = [1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40];
    matlabbatch{3}.spm.temporal.st.refslice = 1;
    matlabbatch{3}.spm.temporal.st.prefix = <span class="string">'a'</span>;
    matlabbatch{4}.spm.spatial.coreg.estwrite.ref(1) = cfg_dep(<span class="string">'Realign: Estimate &amp; Reslice: Mean Image'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{2}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'rmean'</span>));
    matlabbatch{4}.spm.spatial.coreg.estwrite.source = {[<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\anat\sub-'</span> subject <span class="string">'_T1w.nii,1'</span>]};
    matlabbatch{4}.spm.spatial.coreg.estwrite.other = {<span class="string">''</span>};
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.cost_fun = <span class="string">'nmi'</span>;
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.sep = [4 2];
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.tol = [0.02 0.02 0.02 0.001 0.001 0.001 0.01 0.01 0.01 0.001 0.001 0.001];
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.fwhm = [7 7];
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.interp = 4;
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.wrap = [0 0 0];
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.mask = 0;
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.prefix = <span class="string">'r'</span>;
    matlabbatch{5}.spm.spatial.preproc.channel.vols(1) = cfg_dep(<span class="string">'Coregister: Estimate &amp; Reslice: Coregistered Images'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{4}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'cfiles'</span>));
    matlabbatch{5}.spm.spatial.preproc.channel.biasreg = 0.001;
    matlabbatch{5}.spm.spatial.preproc.channel.biasfwhm = 60;
    matlabbatch{5}.spm.spatial.preproc.channel.write = [0 1];
    matlabbatch{5}.spm.spatial.preproc.tissue(1).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,1'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(1).ngaus = 1;
    matlabbatch{5}.spm.spatial.preproc.tissue(1).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(1).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(2).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,2'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(2).ngaus = 1;
    matlabbatch{5}.spm.spatial.preproc.tissue(2).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(2).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(3).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,3'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(3).ngaus = 2;
    matlabbatch{5}.spm.spatial.preproc.tissue(3).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(3).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(4).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,4'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(4).ngaus = 3;
    matlabbatch{5}.spm.spatial.preproc.tissue(4).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(4).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(5).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,5'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(5).ngaus = 4;
    matlabbatch{5}.spm.spatial.preproc.tissue(5).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(5).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(6).tpm = {<span class="string">'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,6'</span>};
    matlabbatch{5}.spm.spatial.preproc.tissue(6).ngaus = 2;
    matlabbatch{5}.spm.spatial.preproc.tissue(6).native = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(6).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.warp.mrf = 1;
    matlabbatch{5}.spm.spatial.preproc.warp.cleanup = 1;
    matlabbatch{5}.spm.spatial.preproc.warp.reg = [0 0.001 0.5 0.05 0.2];
    matlabbatch{5}.spm.spatial.preproc.warp.affreg = <span class="string">'mni'</span>;
    matlabbatch{5}.spm.spatial.preproc.warp.fwhm = 0;
    matlabbatch{5}.spm.spatial.preproc.warp.samp = 3;
    matlabbatch{5}.spm.spatial.preproc.warp.write = [0 1];
    matlabbatch{5}.spm.spatial.preproc.warp.vox = NaN;
    matlabbatch{5}.spm.spatial.preproc.warp.bb = [NaN NaN NaN
                                                  NaN NaN NaN];
    matlabbatch{6}.spm.spatial.normalise.write.subj.def(1) = cfg_dep(<span class="string">'Segment: Forward Deformations'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{5}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'fordef'</span>, <span class="string">'()'</span>,{<span class="string">':'</span>}));
    matlabbatch{6}.spm.spatial.normalise.write.subj.resample(1) = cfg_dep(<span class="string">'Slice Timing: Slice Timing Corr. Images (Sess 1)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{3}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'()'</span>,{1}, <span class="string">'.'</span>,<span class="string">'files'</span>));
    matlabbatch{6}.spm.spatial.normalise.write.subj.resample(2) = cfg_dep(<span class="string">'Slice Timing: Slice Timing Corr. Images (Sess 2)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{3}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'()'</span>,{2}, <span class="string">'.'</span>,<span class="string">'files'</span>));
    matlabbatch{6}.spm.spatial.normalise.write.woptions.bb = [-78 -112 -70
                                                              78 76 85];
    matlabbatch{6}.spm.spatial.normalise.write.woptions.vox = [2 2 2];
    matlabbatch{6}.spm.spatial.normalise.write.woptions.interp = 4;
    matlabbatch{6}.spm.spatial.normalise.write.woptions.prefix = <span class="string">'w'</span>;
    matlabbatch{7}.spm.spatial.smooth.data(1) = cfg_dep(<span class="string">'Normalise: Write: Normalised Images (Subj 1)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{6}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'()'</span>,{1}, <span class="string">'.'</span>,<span class="string">'files'</span>));
    matlabbatch{7}.spm.spatial.smooth.fwhm = [8 8 8];
    matlabbatch{7}.spm.spatial.smooth.dtype = 0;
    matlabbatch{7}.spm.spatial.smooth.im = 0;
    matlabbatch{7}.spm.spatial.smooth.prefix = <span class="string">'s'</span>;
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.name = <span class="string">'run1run2FileSplit'</span>;
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.files(1) = cfg_dep(<span class="string">'Smooth: Smoothed Images'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{7}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'files'</span>));
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.index = {
                                                                         1
                                                                         2
                                                                         }';
    matlabbatch{9}.spm.stats.fmri_spec.dir = {[<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'/1stLevel'</span>]};
    matlabbatch{9}.spm.stats.fmri_spec.timing.units = <span class="string">'secs'</span>;
    matlabbatch{9}.spm.stats.fmri_spec.timing.RT = 2;
    matlabbatch{9}.spm.stats.fmri_spec.timing.fmri_t = 16;
    matlabbatch{9}.spm.stats.fmri_spec.timing.fmri_t0 = 8;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).scans(1) = cfg_dep(<span class="string">'File Set Split: run1run2FileSplit (1)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{8}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'{}'</span>,{1}));
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).name = <span class="string">'Inc'</span>;
</pre><pre class="codeinput">    <span class="comment">% Load the timing files for each condition for each run</span>

    data_incongruent_run1 = load([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\incongruent_run1.txt'</span>]);

    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).onset = data_incongruent_run1(:,1);
</pre><pre class="codeinput">    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).pmod = struct(<span class="string">'name'</span>, {}, <span class="string">'param'</span>, {}, <span class="string">'poly'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).name = <span class="string">'Con'</span>;
</pre><pre class="codeinput">    data_congruent_run1 = load([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\congruent_run1.txt'</span>]);

    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).onset = data_congruent_run1(:,1);
</pre><pre class="codeinput">    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).pmod = struct(<span class="string">'name'</span>, {}, <span class="string">'param'</span>, {}, <span class="string">'poly'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).multi = {<span class="string">''</span>};
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).regress = struct(<span class="string">'name'</span>, {}, <span class="string">'val'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).multi_reg = {<span class="string">''</span>};
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).hpf = 128;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).scans(1) = cfg_dep(<span class="string">'File Set Split: run1run2FileSplit (2)'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{8}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'{}'</span>,{2}));
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).name = <span class="string">'Inc'</span>;
</pre><pre class="codeinput">    data_incongruent_run2 = load([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\incongruent_run2.txt'</span>]);
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).onset = data_incongruent_run2(:,1);
</pre><pre class="codeinput">    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).pmod = struct(<span class="string">'name'</span>, {}, <span class="string">'param'</span>, {}, <span class="string">'poly'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).name = <span class="string">'Con'</span>;
</pre><pre class="codeinput">    data_congruent_run2 = load([<span class="string">'D:\Andrew_Jahn_SPMtut\Flanker_task\sub-'</span> subject <span class="string">'\func\congruent_run2.txt'</span>]);
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).onset = data_congruent_run2(:,1);
</pre><pre class="codeinput">    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).pmod = struct(<span class="string">'name'</span>, {}, <span class="string">'param'</span>, {}, <span class="string">'poly'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).multi = {<span class="string">''</span>};
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).regress = struct(<span class="string">'name'</span>, {}, <span class="string">'val'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).multi_reg = {<span class="string">''</span>};
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).hpf = 128;
    matlabbatch{9}.spm.stats.fmri_spec.fact = struct(<span class="string">'name'</span>, {}, <span class="string">'levels'</span>, {});
    matlabbatch{9}.spm.stats.fmri_spec.bases.hrf.derivs = [0 0];
    matlabbatch{9}.spm.stats.fmri_spec.volt = 1;
    matlabbatch{9}.spm.stats.fmri_spec.global = <span class="string">'None'</span>;
    matlabbatch{9}.spm.stats.fmri_spec.mthresh = 0.8;
    matlabbatch{9}.spm.stats.fmri_spec.mask = {<span class="string">''</span>};
    matlabbatch{9}.spm.stats.fmri_spec.cvi = <span class="string">'AR(1)'</span>;
    matlabbatch{10}.spm.stats.fmri_est.spmmat(1) = cfg_dep(<span class="string">'fMRI model specification: SPM.mat File'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{9}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'spmmat'</span>));
    matlabbatch{10}.spm.stats.fmri_est.write_residuals = 1;
    matlabbatch{10}.spm.stats.fmri_est.method.Classical = 1;
    matlabbatch{11}.spm.stats.con.spmmat(1) = cfg_dep(<span class="string">'Model estimation: SPM.mat File'</span>, substruct(<span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{10}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}, <span class="string">'.'</span>,<span class="string">'val'</span>, <span class="string">'{}'</span>,{1}), substruct(<span class="string">'.'</span>,<span class="string">'spmmat'</span>));
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.name = <span class="string">'Inc-Con'</span>;
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.weights = [1 -1];
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.sessrep = <span class="string">'replsc'</span>;
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.name = <span class="string">'Con-Inc'</span>;
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.weights = [-1 1];
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.sessrep = <span class="string">'replsc'</span>;
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.name = <span class="string">'Inc'</span>;
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.weights = [1 0];
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.sessrep = <span class="string">'replsc'</span>;
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.name = <span class="string">'Con'</span>;
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.weights = [0 1];
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.sessrep = <span class="string">'replsc'</span>;
    matlabbatch{11}.spm.stats.con.delete = 0;

    spm_jobman(<span class="string">'run'</span>, matlabbatch);
</pre><pre class="codeinput"><span class="keyword">end</span>
</pre><p class="footer"><br><a href="https://www.mathworks.com/products/matlab/">Published with MATLABÂ® R2021a</a><br></p></div><!--
##### SOURCE BEGIN #####
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-
% Job saved on 06-Aug-2021 19:11:17 by cfg_util (rev $Rev: 7345 $)
% spm SPM - SPM12 (7771)
% cfg_basicio BasicIO - Unknown
%REPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASHREPLACE_WITH_DASH_DASH-


subjects = [02 03]

%user  = getenv("USERNAME"); % Will return the username

for subject = subjects
    
    subject = num2str(subject, '%02d'); % Zero-pads each number so that the subject ID is 2 characters long
    
    %%%%%%%%%%

    % Check whether the files have been unzipped. If not, unzip them using
    % gunzip

    if exist(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-1_bold.nii']) == 0
        display('Run 1 has not been unzipped; unzipping now')
        gunzip(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-1_bold.nii.gz'])
    else
        display('Run 1 is already unzipped; doing nothing')
    end

    if exist(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-2_bold.nii']) == 0
        display('Run 2 has not been unzipped; unzipping now')
        gunzip(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-2_bold.nii.gz'])
    else
        display('Run 2 is already unzipped; doing nothing')
    end

    if exist(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\anat\sub-' subject '_T1w.nii']) == 0
        display('Anatomical image has not been unzipped; unzipping now')
        gunzip(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\anat\sub-' subject '_T1w.nii.gz'])
    else
        display('Anatomical image is already unzipped; doing nothing')
    end

    %%%%%%%%%%

    % Execute the code specified in the SPM GUI

    matlabbatch{1}.cfg_basicio.file_dir.file_ops.cfg_named_file.name = 'run1run2files';
    matlabbatch{1}.cfg_basicio.file_dir.file_ops.cfg_named_file.files = {
                                                                         {['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-1_bold.nii']}
                                                                         {['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\sub-' subject '_task-flanker_run-2_bold.nii']}
                                                                         }';
    matlabbatch{2}.spm.spatial.realign.estwrite.data{1}(1) = cfg_dep('Named File Selector: run1run2files(1) - Files', substruct('.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','files', '{}',{1}));
    matlabbatch{2}.spm.spatial.realign.estwrite.data{2}(1) = cfg_dep('Named File Selector: run1run2files(2) - Files', substruct('.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','files', '{}',{2}));
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.quality = 0.9;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.sep = 4;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.fwhm = 5;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.rtm = 1;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.interp = 2;
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.wrap = [0 0 0];
    matlabbatch{2}.spm.spatial.realign.estwrite.eoptions.weight = '';
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.which = [2 1];
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.interp = 4;
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.wrap = [0 0 0];
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.mask = 1;
    matlabbatch{2}.spm.spatial.realign.estwrite.roptions.prefix = 'r';
    matlabbatch{3}.spm.temporal.st.scans{1}(1) = cfg_dep('Realign: Estimate & Reslice: Resliced Images (Sess 1)', substruct('.','val', '{}',{2}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','sess', '()',{1}, '.','rfiles'));
    matlabbatch{3}.spm.temporal.st.scans{2}(1) = cfg_dep('Realign: Estimate & Reslice: Resliced Images (Sess 2)', substruct('.','val', '{}',{2}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','sess', '()',{2}, '.','rfiles'));
    matlabbatch{3}.spm.temporal.st.nslices = 40;
    matlabbatch{3}.spm.temporal.st.tr = 2;
    matlabbatch{3}.spm.temporal.st.ta = 1.95;
    matlabbatch{3}.spm.temporal.st.so = [1 3 5 7 9 11 13 15 17 19 21 23 25 27 29 31 33 35 37 39 2 4 6 8 10 12 14 16 18 20 22 24 26 28 30 32 34 36 38 40];
    matlabbatch{3}.spm.temporal.st.refslice = 1;
    matlabbatch{3}.spm.temporal.st.prefix = 'a';
    matlabbatch{4}.spm.spatial.coreg.estwrite.ref(1) = cfg_dep('Realign: Estimate & Reslice: Mean Image', substruct('.','val', '{}',{2}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','rmean'));
    matlabbatch{4}.spm.spatial.coreg.estwrite.source = {['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\anat\sub-' subject '_T1w.nii,1']};
    matlabbatch{4}.spm.spatial.coreg.estwrite.other = {''};
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.cost_fun = 'nmi';
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.sep = [4 2];
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.tol = [0.02 0.02 0.02 0.001 0.001 0.001 0.01 0.01 0.01 0.001 0.001 0.001];
    matlabbatch{4}.spm.spatial.coreg.estwrite.eoptions.fwhm = [7 7];
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.interp = 4;
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.wrap = [0 0 0];
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.mask = 0;
    matlabbatch{4}.spm.spatial.coreg.estwrite.roptions.prefix = 'r';
    matlabbatch{5}.spm.spatial.preproc.channel.vols(1) = cfg_dep('Coregister: Estimate & Reslice: Coregistered Images', substruct('.','val', '{}',{4}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','cfiles'));
    matlabbatch{5}.spm.spatial.preproc.channel.biasreg = 0.001;
    matlabbatch{5}.spm.spatial.preproc.channel.biasfwhm = 60;
    matlabbatch{5}.spm.spatial.preproc.channel.write = [0 1];
    matlabbatch{5}.spm.spatial.preproc.tissue(1).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,1'};
    matlabbatch{5}.spm.spatial.preproc.tissue(1).ngaus = 1;
    matlabbatch{5}.spm.spatial.preproc.tissue(1).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(1).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(2).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,2'};
    matlabbatch{5}.spm.spatial.preproc.tissue(2).ngaus = 1;
    matlabbatch{5}.spm.spatial.preproc.tissue(2).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(2).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(3).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,3'};
    matlabbatch{5}.spm.spatial.preproc.tissue(3).ngaus = 2;
    matlabbatch{5}.spm.spatial.preproc.tissue(3).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(3).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(4).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,4'};
    matlabbatch{5}.spm.spatial.preproc.tissue(4).ngaus = 3;
    matlabbatch{5}.spm.spatial.preproc.tissue(4).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(4).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(5).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,5'};
    matlabbatch{5}.spm.spatial.preproc.tissue(5).ngaus = 4;
    matlabbatch{5}.spm.spatial.preproc.tissue(5).native = [1 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(5).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(6).tpm = {'C:\Users\Hanning Su\Documents\MATLAB\spm12\tpm\TPM.nii,6'};
    matlabbatch{5}.spm.spatial.preproc.tissue(6).ngaus = 2;
    matlabbatch{5}.spm.spatial.preproc.tissue(6).native = [0 0];
    matlabbatch{5}.spm.spatial.preproc.tissue(6).warped = [0 0];
    matlabbatch{5}.spm.spatial.preproc.warp.mrf = 1;
    matlabbatch{5}.spm.spatial.preproc.warp.cleanup = 1;
    matlabbatch{5}.spm.spatial.preproc.warp.reg = [0 0.001 0.5 0.05 0.2];
    matlabbatch{5}.spm.spatial.preproc.warp.affreg = 'mni';
    matlabbatch{5}.spm.spatial.preproc.warp.fwhm = 0;
    matlabbatch{5}.spm.spatial.preproc.warp.samp = 3;
    matlabbatch{5}.spm.spatial.preproc.warp.write = [0 1];
    matlabbatch{5}.spm.spatial.preproc.warp.vox = NaN;
    matlabbatch{5}.spm.spatial.preproc.warp.bb = [NaN NaN NaN
                                                  NaN NaN NaN];
    matlabbatch{6}.spm.spatial.normalise.write.subj.def(1) = cfg_dep('Segment: Forward Deformations', substruct('.','val', '{}',{5}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','fordef', '()',{':'}));
    matlabbatch{6}.spm.spatial.normalise.write.subj.resample(1) = cfg_dep('Slice Timing: Slice Timing Corr. Images (Sess 1)', substruct('.','val', '{}',{3}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('()',{1}, '.','files'));
    matlabbatch{6}.spm.spatial.normalise.write.subj.resample(2) = cfg_dep('Slice Timing: Slice Timing Corr. Images (Sess 2)', substruct('.','val', '{}',{3}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('()',{2}, '.','files'));
    matlabbatch{6}.spm.spatial.normalise.write.woptions.bb = [-78 -112 -70
                                                              78 76 85];
    matlabbatch{6}.spm.spatial.normalise.write.woptions.vox = [2 2 2];
    matlabbatch{6}.spm.spatial.normalise.write.woptions.interp = 4;
    matlabbatch{6}.spm.spatial.normalise.write.woptions.prefix = 'w';
    matlabbatch{7}.spm.spatial.smooth.data(1) = cfg_dep('Normalise: Write: Normalised Images (Subj 1)', substruct('.','val', '{}',{6}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('()',{1}, '.','files'));
    matlabbatch{7}.spm.spatial.smooth.fwhm = [8 8 8];
    matlabbatch{7}.spm.spatial.smooth.dtype = 0;
    matlabbatch{7}.spm.spatial.smooth.im = 0;
    matlabbatch{7}.spm.spatial.smooth.prefix = 's';
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.name = 'run1run2FileSplit';
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.files(1) = cfg_dep('Smooth: Smoothed Images', substruct('.','val', '{}',{7}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','files'));
    matlabbatch{8}.cfg_basicio.file_dir.file_ops.cfg_file_split.index = {
                                                                         1
                                                                         2
                                                                         }';
    matlabbatch{9}.spm.stats.fmri_spec.dir = {['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '/1stLevel']};
    matlabbatch{9}.spm.stats.fmri_spec.timing.units = 'secs';
    matlabbatch{9}.spm.stats.fmri_spec.timing.RT = 2;
    matlabbatch{9}.spm.stats.fmri_spec.timing.fmri_t = 16;
    matlabbatch{9}.spm.stats.fmri_spec.timing.fmri_t0 = 8;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).scans(1) = cfg_dep('File Set Split: run1run2FileSplit (1)', substruct('.','val', '{}',{8}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('{}',{1}));
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).name = 'Inc';

    %%

    % Load the timing files for each condition for each run

    data_incongruent_run1 = load(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\incongruent_run1.txt']);

    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).onset = data_incongruent_run1(:,1);
    %%
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).pmod = struct('name', {}, 'param', {}, 'poly', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(1).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).name = 'Con';
    %%

    data_congruent_run1 = load(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\congruent_run1.txt']);

    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).onset = data_congruent_run1(:,1);
    %%
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).pmod = struct('name', {}, 'param', {}, 'poly', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).cond(2).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).multi = {''};
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).regress = struct('name', {}, 'val', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).multi_reg = {''};
    matlabbatch{9}.spm.stats.fmri_spec.sess(1).hpf = 128;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).scans(1) = cfg_dep('File Set Split: run1run2FileSplit (2)', substruct('.','val', '{}',{8}, '.','val', '{}',{1}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('{}',{2}));
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).name = 'Inc';
    %%
    data_incongruent_run2 = load(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\incongruent_run2.txt']);
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).onset = data_incongruent_run2(:,1);
    %%
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).pmod = struct('name', {}, 'param', {}, 'poly', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(1).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).name = 'Con';
    %%
    data_congruent_run2 = load(['D:\Andrew_Jahn_SPMtut\Flanker_task\sub-' subject '\func\congruent_run2.txt']);
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).onset = data_congruent_run2(:,1);
    %%
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).duration = 2;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).tmod = 0;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).pmod = struct('name', {}, 'param', {}, 'poly', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).cond(2).orth = 1;
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).multi = {''};
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).regress = struct('name', {}, 'val', {});
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).multi_reg = {''};
    matlabbatch{9}.spm.stats.fmri_spec.sess(2).hpf = 128;
    matlabbatch{9}.spm.stats.fmri_spec.fact = struct('name', {}, 'levels', {});
    matlabbatch{9}.spm.stats.fmri_spec.bases.hrf.derivs = [0 0];
    matlabbatch{9}.spm.stats.fmri_spec.volt = 1;
    matlabbatch{9}.spm.stats.fmri_spec.global = 'None';
    matlabbatch{9}.spm.stats.fmri_spec.mthresh = 0.8;
    matlabbatch{9}.spm.stats.fmri_spec.mask = {''};
    matlabbatch{9}.spm.stats.fmri_spec.cvi = 'AR(1)';
    matlabbatch{10}.spm.stats.fmri_est.spmmat(1) = cfg_dep('fMRI model specification: SPM.mat File', substruct('.','val', '{}',{9}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','spmmat'));
    matlabbatch{10}.spm.stats.fmri_est.write_residuals = 1;
    matlabbatch{10}.spm.stats.fmri_est.method.Classical = 1;
    matlabbatch{11}.spm.stats.con.spmmat(1) = cfg_dep('Model estimation: SPM.mat File', substruct('.','val', '{}',{10}, '.','val', '{}',{1}, '.','val', '{}',{1}), substruct('.','spmmat'));
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.name = 'Inc-Con';
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.weights = [1 -1];
    matlabbatch{11}.spm.stats.con.consess{1}.tcon.sessrep = 'replsc';
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.name = 'Con-Inc';
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.weights = [-1 1];
    matlabbatch{11}.spm.stats.con.consess{2}.tcon.sessrep = 'replsc';
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.name = 'Inc';
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.weights = [1 0];
    matlabbatch{11}.spm.stats.con.consess{3}.tcon.sessrep = 'replsc';
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.name = 'Con';
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.weights = [0 1];
    matlabbatch{11}.spm.stats.con.consess{4}.tcon.sessrep = 'replsc';
    matlabbatch{11}.spm.stats.con.delete = 0;
    
    spm_jobman('run', matlabbatch);

end
    

##### SOURCE END #####
--></body></html>